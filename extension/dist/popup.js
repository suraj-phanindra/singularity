import{r as i,j as e,c as b,R as N}from"./chunks/vendor-D7f9BLy3.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&c(r)}).observe(document,{childList:!0,subtree:!0});function l(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(s){if(s.ep)return;s.ep=!0;const a=l(s);fetch(s.href,a)}})();function y(){const[o,n]=i.useState(!0),[l,c]=i.useState("checking"),[s,a]=i.useState(0),[r,d]=i.useState([]);i.useEffect(()=>{u(),h(),f()},[]);const f=async()=>{try{const t=await chrome.storage.local.get(["enabled"]);n(t.enabled!==!1)}catch(t){console.error("Failed to load enabled state:",t)}},u=async()=>{try{(await fetch("http://localhost:8000/health")).ok?c("connected"):c("error")}catch{c("disconnected")}},h=async()=>{try{const t=await chrome.runtime.sendMessage({action:"getContextStats"});t&&(a(t.count||0),d(t.recentFacts||[]))}catch(t){console.error("Failed to load context data:",t)}},x=async()=>{const t=!o;n(t),await chrome.storage.local.set({enabled:t}),await chrome.runtime.sendMessage({action:"toggleExtension",enabled:t})},p=async()=>{confirm("Are you sure you want to clear all stored context?")&&(await chrome.runtime.sendMessage({action:"clearAllContext"}),a(0),d([]))},g=async t=>{confirm("Delete this context item?")&&(await chrome.runtime.sendMessage({action:"deleteFact",factId:t})).success&&await h()},j=()=>{switch(l){case"connected":return"#4ade80";case"disconnected":return"#f87171";case"checking":return"#fbbf24";default:return"#9ca3af"}};return e.jsxs("div",{className:"app",children:[e.jsxs("header",{className:"header",children:[e.jsx("h1",{children:"Singularity"}),e.jsxs("div",{className:"status-indicator",children:[e.jsx("div",{className:"status-dot",style:{backgroundColor:j()}}),e.jsx("span",{className:"status-text",children:l==="connected"?"Connected":l==="disconnected"?"Backend Offline":"Checking..."})]})]}),e.jsx("div",{className:"controls",children:e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:x}),e.jsx("span",{className:"slider"}),e.jsx("span",{className:"label",children:o?"Enabled":"Disabled"})]})}),e.jsx("div",{className:"stats",children:e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-value",children:s}),e.jsx("div",{className:"stat-label",children:"Facts Stored"})]})}),e.jsxs("div",{className:"recent-facts",children:[e.jsx("h3",{children:"Manage Context & Memories"}),r.length===0?e.jsx("p",{className:"empty-state",children:"No context captured yet"}):e.jsx("div",{className:"fact-list-container",children:e.jsx("ul",{className:"fact-list",children:r.map((t,m)=>e.jsxs("li",{className:"fact-item",children:[e.jsxs("div",{className:"fact-content",children:[e.jsx("div",{className:"fact-text",children:t.text}),e.jsxs("div",{className:"fact-meta",children:[e.jsx("span",{className:"fact-platform",children:t.platform}),e.jsx("span",{className:"fact-time",children:w(t.timestamp)})]})]}),e.jsx("button",{className:"delete-btn",onClick:()=>g(t.id),title:"Delete this fact",children:"Ã—"})]},t.id||m))})})]}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{className:"btn btn-secondary",onClick:u,children:"Refresh Status"}),e.jsx("button",{className:"btn btn-danger",onClick:p,disabled:s===0,children:"Clear All Data"})]})]})}function w(o){if(!o)return"";const n=new Date(o),c=new Date-n,s=Math.floor(c/6e4),a=Math.floor(c/36e5),r=Math.floor(c/864e5);return s<1?"just now":s<60?`${s}m ago`:a<24?`${a}h ago`:`${r}d ago`}b.createRoot(document.getElementById("root")).render(e.jsx(N.StrictMode,{children:e.jsx(y,{})}));
