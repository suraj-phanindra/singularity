import{r as i,j as e,c as g,R as j}from"./chunks/vendor-D7f9BLy3.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&c(n)}).observe(document,{childList:!0,subtree:!0});function l(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(t){if(t.ep)return;t.ep=!0;const s=l(t);fetch(t.href,s)}})();function N(){const[r,o]=i.useState(!0),[l,c]=i.useState("checking"),[t,s]=i.useState(0),[n,d]=i.useState([]);i.useEffect(()=>{u(),h()},[]);const u=async()=>{try{(await fetch("http://localhost:8000/health")).ok?c("connected"):c("error")}catch{c("disconnected")}},h=async()=>{try{const a=await chrome.runtime.sendMessage({action:"getContextStats"});a&&(s(a.count||0),d(a.recentFacts||[]))}catch(a){console.error("Failed to load context data:",a)}},f=async()=>{const a=!r;o(a),await chrome.storage.local.set({enabled:a}),await chrome.runtime.sendMessage({action:"toggleExtension",enabled:a})},m=async()=>{confirm("Are you sure you want to clear all stored context?")&&(await chrome.runtime.sendMessage({action:"clearAllContext"}),s(0),d([]))},x=()=>{switch(l){case"connected":return"#4ade80";case"disconnected":return"#f87171";case"checking":return"#fbbf24";default:return"#9ca3af"}};return e.jsxs("div",{className:"app",children:[e.jsxs("header",{className:"header",children:[e.jsx("h1",{children:"Singularity"}),e.jsxs("div",{className:"status-indicator",children:[e.jsx("div",{className:"status-dot",style:{backgroundColor:x()}}),e.jsx("span",{className:"status-text",children:l==="connected"?"Connected":l==="disconnected"?"Backend Offline":"Checking..."})]})]}),e.jsx("div",{className:"controls",children:e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:r,onChange:f}),e.jsx("span",{className:"slider"}),e.jsx("span",{className:"label",children:r?"Enabled":"Disabled"})]})}),e.jsx("div",{className:"stats",children:e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-value",children:t}),e.jsx("div",{className:"stat-label",children:"Facts Stored"})]})}),e.jsxs("div",{className:"recent-facts",children:[e.jsx("h3",{children:"Recent Context"}),n.length===0?e.jsx("p",{className:"empty-state",children:"No context captured yet"}):e.jsx("ul",{className:"fact-list",children:n.slice(0,5).map((a,p)=>e.jsxs("li",{className:"fact-item",children:[e.jsx("div",{className:"fact-text",children:a.text}),e.jsxs("div",{className:"fact-meta",children:[e.jsx("span",{className:"fact-platform",children:a.platform}),e.jsx("span",{className:"fact-time",children:y(a.timestamp)})]})]},p))})]}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{className:"btn btn-secondary",onClick:u,children:"Refresh Status"}),e.jsx("button",{className:"btn btn-danger",onClick:m,disabled:t===0,children:"Clear All Data"})]})]})}function y(r){if(!r)return"";const o=new Date(r),c=new Date-o,t=Math.floor(c/6e4),s=Math.floor(c/36e5),n=Math.floor(c/864e5);return t<1?"just now":t<60?`${t}m ago`:s<24?`${s}h ago`:`${n}d ago`}g.createRoot(document.getElementById("root")).render(e.jsx(j.StrictMode,{children:e.jsx(N,{})}));
